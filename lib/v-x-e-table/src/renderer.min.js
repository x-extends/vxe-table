"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.Renderer=void 0;var _xeUtils=_interopRequireDefault(require("xe-utils")),_tools=require("../../tools");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function defaultRenderer(e,t,r,o){var n=o.$table,a=o.column,u=r.name,l=a.model;return[e(u,{class:"vxe-default-".concat(u),attrs:t,domProps:{value:l.value},on:{input:function(e){var t=e.target.value;l.update=!0,l.value=t,n.updateStatus(o,t)}}})]}var rowHeight=24,_storeMap={input:{autofocus:"input",renderEdit:function(e,t,r){return defaultRenderer(e,{type:"text"},t,r)}},textarea:{autofocus:"textarea",renderEdit:function(e,t,r){return defaultRenderer(e,null,t,r)}},cell:{autofocus:".vxe-textarea",renderEdit:function(e,t,r,o){var n=o.$excel.excelStore.uploadRows,a=r.row,u=r.column,l=u.model;return[e("div",{class:"vxe-input--wrapper vxe-excel-cell",style:{height:"".concat(u.renderHeight-1,"px")}},[e("textarea",{class:"vxe-textarea",style:{width:"".concat(u.renderWidth,"px")},domProps:{value:l.value},on:{input:function(e){var t=e.target;l.update=!0,l.value=t.value,t.scrollHeight>t.offsetHeight&&(-1===n.indexOf(a)?t.style.width="".concat(t.offsetWidth+20,"px"):t.style.height="".concat(t.scrollHeight,"px"))},change:function(e){-1===n.indexOf(a)&&n.push(a)},keydown:function(e){var t=e.target;if(e.altKey&&13===e.keyCode){e.preventDefault(),e.stopPropagation();var r=_tools.DomTools.getCursorPosition(t),o=r.end,n=t.value;n="".concat(n.slice(0,o),"\n").concat(n.slice(o,n.length)),t.value=n,l.update=!0,l.value=n,t.style.height="".concat((Math.floor(t.offsetHeight/rowHeight)+1)*rowHeight,"px"),setTimeout(function(){r.start=r.end=++o,_tools.DomTools.setCursorPosition(t,r)})}}}})])]},renderCell:function(e,t,r){var o=r.row,n=r.column;return[e("span",{domProps:{innerHTML:_xeUtils.default.escape(_tools.UtilTools.getCellValue(o,n)).replace(/\n/g,"<br>")}})]}}},Renderer={mixin:function(e){return _xeUtils.default.each(e,function(e,t){return Renderer.add(t,e)}),Renderer},get:function(e){return _storeMap[e]||null},add:function(e,t){if(e&&t){var r=_storeMap[e];r?Object.assign(r,t):_storeMap[e]=t}return Renderer},delete:function(e){return delete _storeMap[e],Renderer}},_default=exports.Renderer=Renderer;exports.default=_default;