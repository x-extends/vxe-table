"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.Renderer=void 0;var _xeUtils=_interopRequireDefault(require("xe-utils")),_tools=require("../../tools");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function getAttrs(e){var t=e.name,r=e.attrs;return"input"===t&&(r=Object.assign({type:"text"},r)),r}function defaultEditRender(e,t,r){var n=r.row,o=r.column,l=t.name,u=getAttrs(t);return[e("div",{class:"vxe-input--wrapper"},[e(l,{class:"vxe-".concat(l),attrs:u,domProps:{value:_tools.UtilTools.getCellValue(n,o)},on:getEvents(t,r)})])]}function getEvents(e,r){var t=e.name,n=e.events,o=r.$table,l=r.row,u=r.column,i="select"===t?"change":"input",a=_defineProperty({},i,function(e){var t=e.target.value;_tools.UtilTools.setCellValue(l,u,t),o.updateStatus(r,t),n&&n[i]&&n[i](r,e)});return n?_xeUtils.default.assign({},_xeUtils.default.objectMap(n,function(e){return function(){e.apply(null,[r].concat.apply(r,arguments))}}),a):a}function renderOptgroups(r,n,o){var e=n.optionGroups,t=n.optionGroupProps,l=void 0===t?{}:t,u=l.options||"options",i=l.label||"label";return e.map(function(e,t){return r("optgroup",{domProps:{label:e[i]},key:t},renderOptions(r,e[u],n,o))})}function renderOptions(r,e,t,n){var o=t.optionProps,l=void 0===o?{}:o,u=n.row,i=n.column,a=l.label||"label",d=l.value||"value",s=l.disabled||"disabled";return e.map(function(e,t){return r("option",{attrs:{value:e[d],disabled:e[s]},domProps:{selected:e[d]===_tools.UtilTools.getCellValue(u,i)},key:t},e[a])})}function getFilterEvents(t,e,r,n){var o=r.column,l=e.events,u="select"===name?"change":"input",i=_defineProperty({},u,function(e){t.data=e.target.value,handleConfirmFilter(n,o,!!t.data,t),l&&l[u]&&l[u](Object.assign({context:n},r),e)});return l?_xeUtils.default.assign({},_xeUtils.default.objectMap(l,function(e){return function(){r=Object.assign({context:n},r),e.apply(null,[r].concat.apply(r,arguments))}}),i):i}function defaultFilterRender(t,r,n,o){var e=n.column,l=r.name,u=getAttrs(r);return e.filters.map(function(e){return t("div",{class:"vxe-input--wrapper"},[t(l,{class:"vxe-".concat(l),attrs:u,domProps:{value:e.data},on:getFilterEvents(e,r,n,o)})])})}function handleConfirmFilter(e,t,r,n){e[t.filterMultiple?"changeMultipleOption":"changeRadioOption"]({},r,n)}function defaultFilterMethod(e){var t=e.option,r=e.row,n=e.column,o=t.data;return _xeUtils.default.get(r,n.property)==o}function renderSelectEdit(e,t,r){return[e("select",{class:"vxe-default-select",on:getEvents(t,r)},t.optionGroups?renderOptgroups(e,t,r):renderOptions(e,t.options,t,r))]}var renderMap={input:{autofocus:".vxe-input",renderEdit:defaultEditRender,renderDefault:defaultEditRender,renderFilter:defaultFilterRender,filterMethod:defaultFilterMethod},textarea:{autofocus:".vxe-textarea",renderEdit:defaultEditRender,renderDefault:defaultEditRender,renderFilter:defaultFilterRender,filterMethod:defaultFilterMethod},select:{renderEdit:renderSelectEdit,renderDefault:renderSelectEdit,renderCell:function(e,t,r){var n,o=t.options,l=t.optionGroups,u=t.optionProps,i=void 0===u?{}:u,a=t.optionGroupProps,d=void 0===a?{}:a,s=r.row,p=r.column,f=_xeUtils.default.get(s,p.property),c=i.label||"label",v=i.value||"value";if(l){for(var g=d.options||"options",x=0;x<l.length&&!(n=_xeUtils.default.find(l[x][g],function(e){return e[v]===f}));x++);return n?n[c]:f}return(n=_xeUtils.default.find(o,function(e){return e[v]===f}))?n[c]:f},renderFilter:function(t,r,n,o){var e=n.column,l=r.attrs;return e.filters.map(function(e){return t("select",{class:"vxe-default-select",attrs:l,on:getFilterEvents(e,r,n,o)},r.optionGroups?renderOptgroups(t,r,n):renderOptions(t,r.options,r,n))})},filterMethod:defaultFilterMethod}},Renderer={mixin:function(e){return _xeUtils.default.each(e,function(e,t){return Renderer.add(t,e)}),Renderer},get:function(e){return renderMap[e]||null},add:function(e,t){if(e&&t){var r=renderMap[e];r?Object.assign(r,t):renderMap[e]=t}return Renderer},delete:function(e){return delete renderMap[e],Renderer}},_default=exports.Renderer=Renderer;exports.default=_default;