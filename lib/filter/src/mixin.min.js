"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _xeUtils=_interopRequireDefault(require("xe-utils/methods/xe-utils")),_tools=require("../../tools");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _default={methods:{_filter:function(e,t){var i=this.getColumnByField(e),l=i.filters;if(t){var o=t(l);_xeUtils.default.isArray(o)&&(i.filters=_tools.UtilTools.getFilters(o))}return this.$nextTick().then(function(){return l})},triggerFilterEvent:function(e,f,t){var i=this.$refs,n=this.filterStore;if(n.column===f&&n.visible)n.visible=!1;else{var a=i.filterWrapper,u=i.tableBody.$el,c=e.target,h=e.pageX,d=_tools.DomTools.getDomNode().visibleWidth;Object.assign(n,{args:t,multiple:f.filterMultiple,options:f.filters,column:f,style:null,visible:!0}),n.isAllSelected=n.options.every(function(e){return e.checked}),n.isIndeterminate=!n.isAllSelected&&n.options.some(function(e){return e.checked}),this.$nextTick(function(){var e,t,i=a.$el.offsetWidth,l=i/2,o={top:"".concat(c.offsetTop+c.offsetParent.offsetTop+c.offsetHeight+8,"px")};if("left"===f.fixed?e=c.offsetLeft+c.offsetParent.offsetLeft-l:"right"===f.fixed?t=c.offsetParent.offsetWidth-c.offsetLeft+(c.offsetParent.offsetParent.offsetWidth-c.offsetParent.offsetLeft)-f.renderWidth-l:e=c.offsetLeft+c.offsetParent.offsetLeft-l-u.scrollLeft,e){var r=h+i-l+32-d;0<r&&(e-=r),o.left="".concat(Math.max(32,e),"px")}else if(t){var s=h+i-l+32-d;0<s&&(t+=s),o.right="".concat(t,"px")}n.style=o})}},confirmFilterEvent:function(){var e=this.visibleColumn,t=this.filterStore,i=this.remoteFilter,l=this.scrollXLoad,o=this.scrollYLoad,r=t.column,s=r.property,f=[],n=[];r.filters.forEach(function(e){e.checked&&(f.push(e.value),n.push(e.data))}),t.visible=!1,i||this.handleTableData(!0);var a=[];e.filter(function(e){var t=e.property,i=e.filters,l=[],o=[];i&&i.length&&(i.forEach(function(e){e.checked&&(l.push(e.value),o.push(e.data))}),a.push({column:e,property:t,field:t,prop:t,values:l,datas:o}))}),_tools.UtilTools.emitEvent(this,"filter-change",[{column:r,property:s,field:s,prop:s,values:f,datas:n,filters:a,$table:this}]),this.updateFooter(),(l||o)&&(this.clearScroll(),o&&this.updateScrollYSpace()),this.closeFilter(),this.$nextTick(this.recalculate)},resetFilterEvent:function(e){this.filterStore.options.forEach(function(e){e.checked=!1,e.data=e._data}),this.confirmFilterEvent(e)},_clearFilter:function(e){function t(e){var t=e.filters;t&&t.length&&t.forEach(function(e){e.checked=!1,e.data=e._data})}var i=arguments.length?this.getColumnByField(e):null,l=this.filterStore;return i?t(i):this.visibleColumn.forEach(t),i&&i===l.column||Object.assign(l,{isAllSelected:!1,isIndeterminate:!1,style:null,options:[],column:null,multiple:!1,visible:!1}),this.updateData()}}};exports.default=_default;