"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _ctor=_interopRequireDefault(require("xe-utils/ctor")),_conf=_interopRequireDefault(require("../../conf")),_size=_interopRequireDefault(require("../../mixins/size")),_tools=require("../../tools");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _defineProperty(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var autoTxtElem=document.createElement("div"),_default2={name:"VxeTextarea",mixins:[_size.default],props:{value:[String,Number],name:String,readonly:Boolean,disabled:Boolean,placeholder:String,maxlength:[String,Number],rows:{type:[String,Number],default:2},showWordCount:Boolean,autosize:[Boolean,Object],form:String,resize:{type:String,default:function(){return _conf.default.textarea.resize}},size:{type:String,default:function(){return _conf.default.textarea.size||_conf.default.size}}},computed:{inputCount:function(){return _ctor.default.getSize(this.value)},isCountError:function(){return this.maxlength&&this.inputCount>_ctor.default.toNumber(this.maxlength)},defaultEvents:function(){var i=this,n={};return _ctor.default.each(this.$listeners,function(e,t){-1===["change"].indexOf(t)&&(n[t]=i.triggerEvent)}),n.input=this.inputEvent,n},sizeOpts:function(){return Object.assign({minRows:1,maxRows:10},_conf.default.textarea.autosize,this.autosize)}},watch:{value:function(){this.updateAutoTxt()}},mounted:function(){this.value&&(this.updateAutoTxt(),this.handleResize())},render:function(e){var t,i=this.defaultEvents,n=this.value,r=this.vSize,a=this.name,o=this.form,u=this.resize,s=this.placeholder,l=this.readonly,d=this.disabled,c=this.maxlength,f=this.autosize,h=this.showWordCount,p={name:a,form:o,placeholder:s,maxlength:c,readonly:l,disabled:d};return s&&(p.placeholder=_tools.UtilTools.getFuncText(s)),e("div",{class:["vxe-textarea",(t={},_defineProperty(t,"size--".concat(r),r),_defineProperty(t,"is--autosize",f),_defineProperty(t,"is--disabled",d),t)]},[e("textarea",{ref:"textarea",class:"vxe-textarea--inner",domProps:{value:n},attrs:p,style:u?{resize:u}:null,on:i}),h?e("span",{class:["vxe-textarea--count",{"is--error":this.isCountError}]},"".concat(this.inputCount).concat(c?"/".concat(c):"")):null])},methods:{focus:function(){return this.$refs.textarea.focus(),this.$nextTick()},blur:function(){return this.$refs.textarea.blur(),this.$nextTick()},triggerEvent:function(e){var t=this.value;this.$emit(e.type,{value:t,$event:e})},emitUpdate:function(e,t){this.value!==e&&(this.$emit("input",e),this.$emit("change",{value:e,$event:t}))},inputEvent:function(e){this.emitUpdate(e.target.value,e),this.handleResize()},updateAutoTxt:function(){var e=this.$refs,t=this.value,i=this.size;if(this.autosize){autoTxtElem.parentNode||document.body.appendChild(autoTxtElem);var n=e.textarea,r=getComputedStyle(n);autoTxtElem.className=["vxe-textarea--autosize",i?"size--".concat(i):""].join(" "),autoTxtElem.style.width="".concat(n.clientWidth,"px"),autoTxtElem.style.padding=r.padding,autoTxtElem.innerHTML=(""+(t||"　")).replace(/\n$/,"\n　")}},handleResize:function(){var f=this;this.autosize&&this.$nextTick(function(){var e=f.$refs,t=f.sizeOpts,i=t.minRows,n=t.maxRows,r=e.textarea,a=autoTxtElem.clientHeight,o=getComputedStyle(r),u=_ctor.default.toNumber(o.lineHeight),s=_ctor.default.toNumber(o.paddingTop)+_ctor.default.toNumber(o.paddingBottom)+_ctor.default.toNumber(o.borderTopWidth)+_ctor.default.toNumber(o.borderBottomWidth),l=(a-s)/u,d=l&&/[0-9]/.test(l)?l:Math.floor(l)+1,c=d;d<i?c=i:n<d&&(c=n),r.style.height="".concat(c*u+s,"px")})}}};exports.default=_default2;