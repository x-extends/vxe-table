"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _xeUtils=_interopRequireDefault(require("xe-utils")),_conf=_interopRequireDefault(require("../../conf")),_tools=require("../../tools");function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}var _default2={name:"VxeTooltip",props:{value:Boolean,trigger:{type:String,default:function(){return _conf.default.tooltip.trigger}},theme:{type:String,default:function(){return _conf.default.tooltip.theme}},content:[String,Function],zIndex:{type:Number,default:function(){return _conf.default.tooltip.zIndex}},isArrow:{type:Boolean,default:!0}},data:function(){return{isUpdate:!1,visible:!1,message:"",tipStore:{style:{},placement:"",arrowStyle:null}}},watch:{content:function(t){this.message=t},value:function(t){this.isUpdate||this[t?"show":"close"](),this.isUpdate=!1}},mounted:function(){var i,o=this.$el,t=this.trigger,e=this.content,n=this.value,s=o.parentNode;this.message=e,Array.from(o.children).forEach(function(t,e){1<e&&(s.insertBefore(t,o),i||(i=t))}),s.removeChild(o),(this.target=i)&&("hover"===t?(i.onmouseleave=this.mouseleaveEvent,i.onmouseenter=this.mouseenterEvent):"click"===t&&(i.onclick=this.clickEvent)),n&&this.show()},beforeDestroy:function(){var t=this.$el,e=this.target,i=this.trigger,o=t.parentNode;o&&o.removeChild(t),e&&("hover"===i?(e.onmouseleave=null,e.onmouseenter=null):"click"===i&&(e.onclick=null))},render:function(t){var e=this.theme,i=this.message,o=this.isArrow,n=this.visible,s=this.tipStore;return t("div",{class:["vxe-table--tooltip-wrapper","theme--".concat(e),"placement--".concat(s.placement),{"is--visible":n,"is--arrow":o}],style:s.style,ref:"tipWrapper"},[t("div",{class:"vxe-table--tooltip-content"},this.$slots.content||i),t("div",{class:"vxe-table--tooltip-arrow",style:s.arrowStyle})].concat(this.$slots.default))},methods:{show:function(){return this.toVisible(this.target)},close:function(){return Object.assign(this.tipStore,{style:{},placement:"",arrowStyle:null}),this.update(!1),this.$nextTick()},update:function(t){t!==this.visible&&(this.visible=t,this.isUpdate=!0,this.$listeners.input&&this.$emit("input",this.visible))},toVisible:function(o,t){var n=this;if(o){var s=this.$el,l=this.tipStore,r=this.zIndex,e=_tools.DomTools.getAbsolutePos(o),a=e.top,c=e.left,i=_tools.DomTools.getDomNode(),u=i.scrollTop,h=i.scrollLeft,f=i.visibleWidth,p=s.parentNode,d=c;return l.placement="top",l.style={width:"auto"},l.arrowStyle={left:"50%"},p||document.body.appendChild(s),t&&(this.message=t),this.update(!0),this.$nextTick().then(function(){var t=s;if(t){var e=t.clientHeight,i=_xeUtils.default.toNumber(getComputedStyle(t).width);return d=c+Math.floor((o.offsetWidth-i)/2),l.style={zIndex:r,width:"".concat(i,"px"),top:"".concat(a-e-6,"px"),left:"".concat(d,"px")},n.$nextTick()}}).then(function(){var t=s;if(t){var e=t.clientHeight,i=t.clientWidth;Object.assign(l.style,{top:"".concat(a-e-6,"px"),left:"".concat(d,"px")}),a-e<u+6&&(l.placement="bottom",l.style.top="".concat(a+o.offsetHeight+6,"px")),d<h+6?(d=h+6,l.arrowStyle.left="".concat(d+16<c?c-d+16:16,"px"),l.style.left="".concat(d,"px")):h+f<d+i&&(d=h+f-i-6,l.arrowStyle.left="".concat(i-Math.max(Math.floor((d+i-c)/2),22),"px"),l.style.left="".concat(d,"px"))}})}return this.$nextTick()},clickEvent:function(t){this[this.visible?"close":"show"]()},mouseleaveEvent:function(t){this.close()},mouseenterEvent:function(t){this.show()}}};exports.default=_default2;