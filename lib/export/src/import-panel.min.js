"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _ctor=_interopRequireDefault(require("xe-utils/ctor")),_conf=_interopRequireDefault(require("../../conf")),_modal=_interopRequireDefault(require("../../modal/src/modal")),_radio=_interopRequireDefault(require("../../radio/src/radio")),_tools=require("../../tools");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _default={name:"VxeImportPanel",props:{defaultOptions:Object,storeData:Object},components:{VxeModal:_modal.default,VxeRadio:_radio.default},data:function(){return{loading:!1}},computed:{vSize:function(){return this.size||this.$parent.size||this.$parent.vSize},selectName:function(){return"".concat(this.storeData.filename,".").concat(this.storeData.type)},hasFile:function(){return this.storeData.file&&this.storeData.type},parseTypeLabel:function(){var e=this.storeData,t=e.type,i=e.typeList;if(t){var a=_ctor.default.find(i,function(e){return t===e.value});return a?_conf.default.i18n(a.label):"*.*"}return"*.".concat(i.map(function(e){return e.value}).join(", *."))}},render:function(t){var e=this.hasFile,i=this.parseTypeLabel,a=this.defaultOptions,o=this.storeData,n=this.selectName;return t("vxe-modal",{res:"modal",props:{value:o.visible,title:_conf.default.i18n("vxe.import.impTitle"),width:440,mask:!0,lockView:!0,showFooter:!1,escClosable:!0,maskClosable:!0,loading:this.loading},on:{input:function(e){o.visible=e}}},[t("div",{class:"vxe-export--panel"},[t("table",{attrs:{cellspacing:0,cellpadding:0,border:0}},[t("tbody",[t("tr",[t("td",_conf.default.i18n("vxe.import.impFile")),t("td",[e?t("div",{class:"vxe-import-selected--file",attrs:{title:n}},[t("span",n),t("i",{class:_conf.default.icon.INPUT_CLEAR,on:{click:this.clearFileEvent}})]):t("span",{class:"vxe-import-select--file",on:{click:this.selectFileEvent}},_conf.default.i18n("vxe.import.impSelect"))])]),t("tr",[t("td",_conf.default.i18n("vxe.import.impType")),t("td",i)]),t("tr",[t("td",_conf.default.i18n("vxe.import.impOpts")),t("td",[t("vxe-radio-group",{props:{value:a.mode},on:{input:function(e){a.mode=e}}},o.modeList.map(function(e){return t("vxe-radio",{props:{label:e.value}},_conf.default.i18n(e.label))}))])])])]),t("div",{class:"vxe-export--panel-btns"},[t("vxe-button",{props:{status:"primary",disabled:!e},on:{click:this.importEvent}},_conf.default.i18n("vxe.import.impConfirm"))])])])},methods:{clearFileEvent:function(){Object.assign(this.storeData,{filename:"",sheetName:"",type:""})},selectFileEvent:function(){var i=this;this.$parent.readFile(this.defaultOptions).then(function(e){var t=e.target.files[0];Object.assign(i.storeData,_tools.UtilTools.parseFile(t),{file:t})}).catch(function(e){return e})},importEvent:function(){var e=this,t=this.$parent;this.loading=!0,t.importByFile(this.storeData.file,Object.assign({},t.importOpts,this.defaultOptions)).then(function(){e.loading=!1,e.storeData.visible=!1})}}};exports.default=_default;